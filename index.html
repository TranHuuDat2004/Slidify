<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slidify - Ch·ªçn m√¥n h·ªçc</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/homepage.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="icon" href="images/favicon.png" type="image/x-icon">

    <!-- 1. T√≠ch h·ª£p CSS c·ªßa Driver.js -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/driver.js@1.0.1/dist/driver.css"/>

    <style>
        /* CSS cho n√∫t Help/Tour */
        .tour-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #fff;
            border: 1px solid #ddd;
            color: #333;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            z-index: 999;
            font-size: 24px;
            transition: transform 0.2s, background-color 0.2s;
        }

        .tour-btn:hover {
            transform: scale(1.1);
            background-color: #f8f9fa;
        }

        /* T√πy ch·ªânh giao di·ªán Popover c·ªßa Driver.js */
        .driver-popover.driverjs-theme {
            background-color: #fff;
            color: #333;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .driver-popover.driverjs-theme .driver-popover-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 8px;
            color: #000;
        }
        
        .driver-popover.driverjs-theme .driver-popover-description {
            font-size: 14px;
            line-height: 1.5;
            color: #555;
        }

        .driver-popover.driverjs-theme button {
            background-color: #007bff; /* M√†u ch·ªß ƒë·∫°o gi·∫£ ƒë·ªãnh */
            color: #fff;
            text-shadow: none;
            border: none;
            border-radius: 4px;
            padding: 6px 12px;
        }
    </style>
</head>

<body>

    <!-- === SIDEBAR CH√çNH (B√äN TR√ÅI) === -->
    <nav id="left-sidebar" class="sidebar left-sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo-container">
                <img src="images/logo.png" alt="Slidify Logo" class="logo">
            </div>
            <button id="close-left-sidebar-btn" class="close-sidebar-btn">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <a href="index.html">Trang Ch·ªß</a>
        <a href="#">Gi·ªõi Thi·ªáu</a>
    </nav>
    
    <!-- === L·ªöP PH·ª¶ (OVERLAY) === -->
    <div id="overlay"></div>

    <!-- Header Placeholder -->
    <header id="header-placeholder"></header>

    <!-- 2. N√∫t k√≠ch ho·∫°t l·∫°i Tour -->
    <div class="tour-btn" id="restart-tour" title="H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng">‚ùì</div>

    <main class="homepage-main">
        <h1 id="welcome-title">Ch√†o m·ª´ng ƒë·∫øn v·ªõi Slidify</h1>
        <p>Ch·ªçn m·ªôt m√¥n h·ªçc b√™n d∆∞·ªõi ƒë·ªÉ b·∫Øt ƒë·∫ßu ghi ch√∫ v√† kh√°m ph√° ki·∫øn th·ª©c.</p>

        <div id="course-list-container" class="course-list-container">
            <!-- C√°c th·∫ª m√¥n h·ªçc s·∫Ω ƒë∆∞·ª£c t·∫°o t·ª± ƒë·ªông b·∫±ng JavaScript -->
        </div>
    </main>

    <footer id="footer-placeholder"></footer>

    <!-- Nh√∫ng c√°c file JS c·∫ßn thi·∫øt -->
    <script src="js/main.js"></script>

    <!-- 3. T√≠ch h·ª£p Script c·ªßa Driver.js -->
    <script src="https://cdn.jsdelivr.net/npm/driver.js@1.0.1/dist/driver.js.iife.js"></script>

    <script>
        // H√†m load header/footer
        function loadComponent(filePath, elementId) {
            fetch(filePath)
                .then(response => response.text())
                .then(data => { document.getElementById(elementId).innerHTML = data; });
        }

        document.addEventListener('DOMContentLoaded', () => {
            // N·∫°p header v√† footer
            loadComponent('header.html', 'header-placeholder');
            loadComponent('footer.html', 'footer-placeholder');

            // Hi·ªÉn th·ªã danh s√°ch m√¥n h·ªçc t·ª´ courses.json
            const courseContainer = document.getElementById('course-list-container');
            
            fetch('js/courses.json')
                .then(response => response.json())
                .then(courses => {
                    courses.forEach(course => {
                        const courseCard = document.createElement('a');
                        courseCard.className = 'course-card';
                        courseCard.href = `subject.html?course=${course.id}`;

                        courseCard.innerHTML = `
                            <img src="${course.thumbnail}" alt="${course.title}">
                            <div class="course-card-content">
                                <h3>${course.title}</h3>
                                <p>${course.description}</p>
                            </div>
                        `;
                        courseContainer.appendChild(courseCard);
                    });

                    // === 4. KH·ªûI T·∫†O TOUR SAU KHI D·ªÆ LI·ªÜU ƒê√É LOAD ===
                    // Ch√∫ng ta g·ªçi h√†m initTour ·ªü ƒë√¢y ƒë·ªÉ ƒë·∫£m b·∫£o c√°c th·∫ª course-card ƒë√£ xu·∫•t hi·ªán
                    initSlidifyTour();
                })
                .catch(error => {
                    console.error('Error loading courses:', error);
                    courseContainer.innerHTML = '<p>L·ªói khi t·∫£i danh s√°ch m√¥n h·ªçc.</p>';
                });
        });

        function initSlidifyTour() {
            const driver = window.driver.js.driver;
            
            const driverObj = driver({
                showProgress: true,
                animate: true,
                doneBtnText: 'B·∫Øt ƒë·∫ßu h·ªçc ngay!',
                nextBtnText: 'Ti·∫øp theo',
                prevBtnText: 'Quay l·∫°i',
                popoverClass: 'driverjs-theme', // Class CSS t√πy ch·ªânh
                steps: [
                    { 
                        element: '#welcome-title', 
                        popover: { 
                            title: 'Ch√†o m·ª´ng ƒë·∫øn v·ªõi Slidify! üéì', 
                            description: 'N·ªÅn t·∫£ng h·ªó tr·ª£ h·ªçc t·∫≠p v√† ghi ch√∫ th√¥ng minh c·ªßa b·∫°n.', 
                            side: "bottom", 
                            align: 'center' 
                        } 
                    },
                    { 
                        element: '#header-placeholder', 
                        popover: { 
                            title: 'Thanh c√¥ng c·ª•', 
                            description: 'N∆°i b·∫°n c√≥ th·ªÉ t√¨m ki·∫øm b√†i gi·∫£ng ho·∫∑c truy c·∫≠p c√°c c√†i ƒë·∫∑t hi·ªÉn th·ªã.', // ƒê√£ s·ª≠a n·ªôi dung t·∫°i ƒë√¢y
                            side: "bottom", 
                            align: 'center' 
                        } 
                    },
                    { 
                        element: '#course-list-container', 
                        popover: { 
                            title: 'Kho m√¥n h·ªçc', 
                            description: 'T·∫•t c·∫£ c√°c m√¥n h·ªçc hi·ªán c√≥ ƒë·ªÅu n·∫±m ·ªü ƒë√¢y. H√£y ch·ªçn m·ªôt m√¥n ƒë·ªÉ b·∫Øt ƒë·∫ßu xem b√†i gi·∫£ng.', 
                            side: "top", 
                            align: 'center' 
                        } 
                    },
                    { 
                        element: '#restart-tour', 
                        popover: { 
                            title: 'H·ªó tr·ª£', 
                            description: 'B·∫•m v√†o n√∫t n√†y b·∫•t c·ª© l√∫c n√†o n·∫øu b·∫°n mu·ªën xem l·∫°i h∆∞·ªõng d·∫´n.', 
                            side: "left", 
                            align: 'center' 
                        } 
                    }
                ]
            });

            // Logic t·ª± ƒë·ªông ch·∫°y l·∫ßn ƒë·∫ßu
            const hasSeenTour = localStorage.getItem('hasSeenSlidifyTour');
            if (!hasSeenTour) {
                // Delay 500ms ƒë·ªÉ ƒë·∫£m b·∫£o layout ·ªïn ƒë·ªãnh ho√†n to√†n
                setTimeout(() => {
                    driverObj.drive();
                    localStorage.setItem('hasSeenSlidifyTour', 'true');
                }, 500);
            }

            // G√°n s·ª± ki·ªán cho n√∫t ?
            document.getElementById('restart-tour').addEventListener('click', () => {
                driverObj.drive();
            });
        }
    </script>
</body>

</html>